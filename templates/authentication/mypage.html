<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="/static/js/script.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  <title>ë‚˜ì—ê²Œ ì“°ëŠ” í¸ì§€</title>
  <link rel="stylesheet" href="/static/css/authentication/mypage.css">
  <style>
    body { font-family: Arial, sans-serif; max-width: 1200px; margin: auto; }
  </style>
</head>
<body>
  <header style="position: relative;">
    <h1 class="main-logo">
      <a href="/" style="text-decoration: none; color: #805a46; font-family: 'KCC-Sonkeechung';">A Letter To Myself</a>
    </h1>
  </header>

  <div class="hamburger-btn">
    <img src="/static/images/poststamp.png" alt="ìš°í‘œìŠ¤í‹°ì»¤ UI" width="50px">
  </div>
  <div class="page_cover"></div>

  <div id="menu">
    <ul class="nav">
      <li><a href="/letters/writing/">í¸ì§€ ì“°ê¸°</a></li>
      <li><a href="/letters/letter/">í¸ì§€ ëª©ë¡</a></li>
      <li><a href="/routines/">í¸ì§€ ë£¨í‹´</a></li>
      <li><a href="/auth/mypage/">ë§ˆì´í˜ì´ì§€</a></li>
      <li><a href="/auth/logout/">ë¡œê·¸ì•„ì›ƒ</a></li>
      <li><a href="/auth/signup/">íšŒì›ê°€ì…</a></li>
    </ul>
  </div>

  <div class="mypage-container">
    <div class="tab-section active" id="profile">
      <div class="profile-card">
        <div class="profile-banner"></div>
        <div class="profile-info">
          <img src="/static/images/basicprofile.png" class="profile-img" alt="ê¸°ë³¸ ì´ë¯¸ì§€">
          <h2>ì‚¬ìš©ìì´ë¦„</h2>
          <p class="email">email@example.com</p>
          <p class="nickname">ë‹‰ë„¤ì„: ì‚¬ìš©ìë‹‰ë„¤ì„</p>
          <p class="bio">í•œì¤„ì†Œê°œ: ì‚¬ìš©ì ì†Œê°œ ë¬¸êµ¬</p>
          <p class="birthday">ìƒì¼: 1990-01-01</p>
          <p class="blog-url">ë¸”ë¡œê·¸: <a href="https://blog.example.com" target="_blank">https://blog.example.com</a></p>
          <a href="/profile/edit/" class="btn profile-edit-btn">í”„ë¡œí•„ ìˆ˜ì •</a>
        </div>
      </div>
    </div>

    <div class="activity-stats">
      <div class="stat-box"><strong>0</strong><p>í¸ì§€</p></div>
      <div class="stat-box"><strong>í–‰ë³µ</strong><p>ìµœê·¼ ë‚˜ì˜ ê°ì •</p></div>
      <div class="stat-box"><strong>3</strong><p>ë£¨í‹´</p></div>
    </div>

    <div class="section-tabs">
      <button class="tab-btn active" data-target="letters">ê°ì •ë¶„ì„</button>
      <button class="tab-btn" data-target="calendar">ë£¨í‹´ ìº˜ë¦°ë”</button>
      <button class="tab-btn" data-target="profile">í”„ë¡œí•„</button>
    </div>

    <div class="section-content">
      <div id="letters" class="tab-section active">
        <div class="chatbot-section">
          <h2>ğŸ“œ ê°ì • ë¶„ì„ ê²°ê³¼</h2>
          <p>ê°€ì¥ ë§ì´ ëŠë‚€ ê°ì •ì€ <strong>í–‰ë³µ</strong>ì…ë‹ˆë‹¤.</p>
          <canvas id="moodChart"></canvas>
          <p style="white-space: pre-line;"><br>ì‘ì›ì˜ ë©”ì‹œì§€: ì˜¤ëŠ˜ë„ ìˆ˜ê³ í–ˆì–´ìš” ğŸŒ¸</p>

          <div class="recommendations mt-4">
            <h3>ğŸ¬ ì¶”ì²œ ì˜í™” & ğŸµ ìŒì•…</h3>

            <h4>ğŸ¬ ì˜í™” ì¶”ì²œ</h4>
            <div class="mb-3 p-3 border rounded bg-light">
              <p class="mb-2">ì¸ì‚¬ì´ë“œ ì•„ì›ƒ</p>
              <div class="d-flex flex-wrap justify-content-end gap-2">
                <button class="btn btn-outline-success btn-sm">ğŸ‘ ì¢‹ì•„ìš”</button>
                <button class="btn btn-outline-danger btn-sm">ğŸ‘ ë³„ë¡œì˜ˆìš”</button>
              </div>
            </div>

            <h4>ğŸµ ìŒì•… ì¶”ì²œ</h4>
            <div class="mb-3 p-3 border rounded bg-light">
              <p class="mb-2">ì–´ë°˜ìì¹´íŒŒ - ê·¸ë‚ ì— ìš°ë¦¬</p>
              <div class="d-flex flex-wrap justify-content-end gap-2">
                <button class="btn btn-outline-success btn-sm">ğŸ‘ ì¢‹ì•„ìš”</button>
                <button class="btn btn-outline-danger btn-sm">ğŸ‘ ë³„ë¡œì˜ˆìš”</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="calendar" class="tab-section">
        <div class="routine_calendar">
          <div id="calendarArea"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ìº˜ë¦°ë” ëª¨ë‹¬ -->
  <div class="modal fade" id="routineModal" tabindex="-1" aria-labelledby="routineModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content rounded-4">
        <div class="modal-header">
          <h5 class="modal-title" id="routineModalLabel">ë£¨í‹´ ì¼ì •</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
        </div>
        <div class="modal-body" id="modalRoutineContent"></div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const moodData = {
        "í–‰ë³µ": 3,
        "ìŠ¬í””": 1,
        "ë¶„ë…¸": 0,
        "ë†€ëŒ": 2
      };

      const ctx = document.getElementById('moodChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(moodData),
          datasets: [{
            label: 'ê°ì • ê¸°ë¡ íšŸìˆ˜',
            data: Object.values(moodData),
            backgroundColor: 'rgba(255, 159, 64, 0.6)',
            borderColor: 'rgb(255, 159, 64)',
            borderWidth: 1
          }]
        },
        options: {
          indexAxis: 'y',
          scales: {
            x: { beginAtZero: true }
          }
        }
      });

      // íƒ­ ì „í™˜
      const tabButtons = document.querySelectorAll(".tab-btn");
      const tabSections = document.querySelectorAll(".tab-section");
      tabButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          tabButtons.forEach(b => b.classList.remove("active"));
          tabSections.forEach(s => s.classList.remove("active"));
          btn.classList.add("active");
          document.getElementById(btn.dataset.target).classList.add("active");
        });
      });

      // FullCalendar
      const calendarEl = document.getElementById("calendarArea");
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: "dayGridMonth",
        locale: "ko",
        events: "/api/routines/",
        height: 500,
        dateClick: function(info) {
          const modalBody = document.getElementById("modalRoutineContent");
          modalBody.innerHTML = `<p>${info.dateStr}ì— ë“±ë¡ëœ ë£¨í‹´ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
          new bootstrap.Modal(document.getElementById("routineModal")).show();
        }
      });

      if (document.getElementById("calendar").classList.contains("active")) {
        calendar.render();
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
